---
# front matter tells Jekyll to process Liquid
---
<!DOCTYPE html>
<html class=" js no-touch svg inlinesvg svgclippaths no-ie8compat" style="">
  {% include head.html %}
  <body class="homepage homepage_index">
    {% include header.html %}
    <main class="content container" role="main">
      <div class="content-row">
	{% include nav.html %}
        <article class="inner-content">
          <div class="inner-content">
	    <h1 id="the-chair-of-br-network-architectures-and-services">Table 1 / Figure 1</h1>
	    <p><img src="{{site.url}}/figures/motivation/pcap/all-filtered.pdf.svg" style="display:block;margin-left:auto;margin-right:auto;width=90%;" alt="low-latency/figures/motivation/pcap/all-filtered.pdf.svg"/></p>
	    <p><img src="{{site.url}}/figures/motivation/pcap/latencies-pre-rate10000-snort-norules.pcap.worst-filtered.pdf.svg" style="display:block;margin-left:auto;margin-right:auto;width=50%;"/></p>
	    <h2>Steps to reproduce measurements</h2>

            <h3>Images</h3>
	    <p>For this measurement all systems use a regular <a href="{{site.url}}/setup.html#dut-linuxregular">Debian buster</a></p>

	    <h3>Setup</h3>
            <ul>
            <li>Setup <a href="{{site.url}}/setup.html#loadgen">loadgen</a></li>
	    <li>Setup device under test (DuT):
		    <ul>
			    <li>Boot VM host with <a href="{{site.url}}/setup.html#dut-bootregular">boot parameters</a></li>
			    <li>Setup of <a href="{{site.url}}/setup.html#dut-prepvm">VM host</a></li>
			    <li>Boot VM with <a href="{{site.url}}/setup.html#dut-bootvmregular">boot parameters</a></li>
			    <li>Install VM <a href="{{site.url}}/setup.html#dut-apt">dependencies</a></li>
			    <li>Setup <a href="{{site.url}}/setup.html#dut-snortsetupregular">Snort</a> on VM</li></ul> </li>
            <li>Setup <a href="{{site.url}}/setup.html#timestamper">timestamper</a></li>
            </ul>
	    <h3>Experiment execution</h3>
            <p>1. Start Snort forwarder in the VM running on the DuT:
	    <pre><code>taskset -c 1 /opt/snort/bin/snort -c /root/low-latency/configs/snort/snort-norules.lua --daq-dir /usr/local/lib/daq --daq-dir /opt/snort/lib/daq --daq afpacket --daq-var fanout_type=hash --max-packet-threads 1 -Q -i ens3:ens4</pre></code>
	    </p>

            <p>2. Wait until Snort is started, then start MoonGen on the LoadGen:
	    <pre><code>/root/moongen/build/MoonGen /root/moongen/examples/moonsniff/traffic-gen.lua --src-mac 52:54:00:8d:9d:ad --dst-mac 52:54:00:21:f8:29 --fix-packetrate 10000 --packets 300000 --warm-up 30 --l4-dst 53 --flows 10 --burst 1 1 0</pre></code>
	    </p>

            <p>3. After Moongen on the LoadGen has started 1000 packets are sent to warm up the DuT. After that packet generation is paused for 30 seconds. In this pause MoonGen's packet sniffer on the timestamper should be started to record the actual measurement:
	    <pre><code>/root/moongen/build/MoonGen /root/moongen/examples/moonsniff/sniffer.lua 1 0 --capture --time 45 --snaplen 256</pre></code>
	    </p>

            <p>4. The timestamper stops recording after 45 seconds and creates the two pcap files latencies-pre.pcap and latencies-post.pcap which can be used for evaluation.</p>

	    <h2>Steps to reproduce figures</h2>
	    <h3>Raw data</h3>
	    <p><a href="https://github.com/gallenmu/low-latency/tree/master/measurements/motivation/pcap">Pcaps</a></p>
	    <h3>Evaluation execution</h3>
            <ul>
            <li>Setup <a href="{{site.url}}/setup.html#evaluator">evaluator</a></li>
            </ul>
	    <pre><code>git clone https://github.com/gallenmu/low-latency
cd low-latency/figures/motivation/pcap
su postgres -c "createuser -s root"
dropdb --if-exists root
createdb root
export PGDATABASE=root
../../../scripts/pcap-import.sh ../../../measurements/motivation/pcap/latencies-pre-rate10000-snort-norules.pcap
../../../scripts/pcap-analysis.sh ../../../measurements/motivation/pcap/latencies-pre-rate10000-snort-norules.pcap
python3 ../../../scripts/pcap-tex-create.py .
for i in *.tex; do lualatex $i; done
	    </code></pre>
	    <h3>Output</h3>
	    <p>The precompiled output files can be found in the <a href="https://github.com/gallenmu/low-latency/tree/master/figures/motivation">repository</a>. For this measurement all-filtered.pdf and latencies-pre-rate10000-snort-norules.pcap.worst-filtered.pdf were used.</p>
          </div>
        </article>
      </div>
    </main>
    {% include footer.html %}
</body></html>
